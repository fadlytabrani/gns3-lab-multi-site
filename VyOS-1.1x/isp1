# OSPF authentication details should be same on all ISP routers.
OSPF_MD5_KEYID=1
OSPF_MD5_KEY=changeme

set system host-name 'isp1'

set interfaces ehternet eth0 description 'uplink internet'
set interfaces ethernet eth0 address 'dhcp'
set interfaces ethernet eth0 ip ospf authentication md5 key-id $OSPF_MD5_KEYID md5-key $OSPF_MD5_KEY

set interfaces ethernet eth1 address 'uplink s1-r1'
set interfaces ethernet eth1 address '100.127.1.1/30'

# Source NAT for the public block.
set nat source rule 1 outbound-interface 'eth0'
set nat source rule 1 source address '100.127.1.0/24'
set nat source rule 1 translation address 'masquerade'

# Route the public block towards s1-r1.
set protocols static route 100.127.1.0/24 next-hop '100.127.1.2'

# OSPF for ISP interconnectivity.
set protocols ospf area 0 authentication 'md5'
set protocols ospf area 0 network '192.168.122.0/24'
set protocols ospf passive-interface 'default'
set protocols ospf passive-interface-exclude 'eth0'
set protocols ospf redistribute 'static'
